{% extends "base.html" %}
{% block title %}Search - Silicon Friendly{% endblock %}

{% block content %}
<section class="page-section">
    <h1>> search</h1>

    <form action="/search/" method="get" class="search-form" toolname="search_directory" tooldescription="Search the Silicon Friendly directory for AI-agent-friendly websites">
        {% if is_logged_in %}
        <div class="search-mode-toggle">
            <a href="?q={{ query }}&mode=keyword" class="search-mode-btn {% if mode == 'keyword' %}active{% endif %}">[ keyword ]</a>
            <a href="?q={{ query }}&mode=semantic" class="search-mode-btn {% if mode == 'semantic' %}active{% endif %}">[ semantic ]</a>
            {% if mode == 'semantic' %}
            <span class="semantic-quota">{{ semantic_remaining }}/5 left today</span>
            {% endif %}
        </div>
        <input type="hidden" name="mode" value="{{ mode }}">
        {% endif %}
        <div class="terminal-input">
            <span class="prompt">> query:</span>
            <input type="text" name="q" value="{{ query }}" placeholder="search for websites..." autocomplete="off">
            <button type="submit">[ > SEARCH ]</button>
        </div>
    </form>

    {% if query %}
    <p class="result-count">> {{ results|length }} result(s) for "{{ query }}"{% if mode == 'semantic' %} (semantic){% endif %}</p>
    {% endif %}

    {% if results %}
    <div class="results-list">
        {% for site in results %}
        <a href="/w/{{ site.url }}/" class="result-item">
            <pre>  L{{ site.level }} {% if site.verified %}[*]{% else %}[ ]{% endif %} {{ site.name }} ({{ site.url }})
     {{ site.description|truncatechars:60 }}</pre>
        </a>
        {% endfor %}
    </div>
    {% elif query %}
    <pre>
┌────────────────────────────────────────┐
│  no results found.                     │
│  try different keywords.               │
└────────────────────────────────────────┘
    </pre>
    {% endif %}
</section>
{% endblock %}
